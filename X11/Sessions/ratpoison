#! /bin/bash
# contents: Ratpoison X11 Session.
#
# Copyright © 2006 Nikolai Weibull <now@bitwi.se>

# Find a file we can redirect output to.
for errfile in "$HOME/.local/var/log/ratpoison-errors" \
               "${TMPDIR-/tmp}/ratpoison-$USER" \
               "/tmp/ratpoison-$USER"; do
  if ( cp /dev/null "$errfile" 2> /dev/null ); then
    chmod 600 "$errfile"
    exec > "$errfile" 2>&1
    break
  fi
done

userfonts=$HOME/.local/share/fonts
userresources=$HOME/.local/etc/X11/Xresources
ratpoisonrc=$HOME/.local/etc/ratpoisonrc

# Add directory where additional X11 fonts can be found.
if [ -d $userfonts ]; then
  xset +fp $userfonts
fi

# Merge user’s resource file into the X session.
if [ -f $userresources ]; then
  xrdb -merge $userresources
fi

# Start a DBUS session.
if [ -x /etc/X11/xinit/xinitrc.d/30-dbus ]; then
  . /etc/X11/xinit/xinitrc.d/30-dbus
fi

# Start ratpoison(1).
exec /usr/local/bin/ratpoison -f $ratpoisonrc
